@model IEnumerable<FAKKE_NEWS_MVC.Models.News>
@{
    ViewData["Title"] = "Inicio";
}

<h3 class="fw-bold mb-2" style="letter-spacing:.4px;">ÚLTIMAS NOTICIAS AGREGADAS</h3>
@if (Model != null && Model.Any())
{
    <div class="news-strip" id="newsStrip">
        @foreach (var item in Model)
        {
            <a class="strip-card" asp-controller="News" asp-action="Edit" asp-route-id="@item.Id" title="@item.Title">
                <div class="strip-image-wrapper">
                    @if (!string.IsNullOrEmpty(item.ImagePath))
                    {
                        <img src="@item.ImagePath" alt="@item.Title" class="strip-image" />
                    }
                    else
                    {
                        <div class="strip-image placeholder-gradient"></div>
                    }
                    <div class="strip-overlay">
                        <span class="strip-title">@item.Title</span>
                        <span class="strip-desc">@item.Content</span>
                    </div>
                </div>
            </a>
        }
    </div>
}

<!-- Panel de administración rápida eliminado a solicitud -->

<style>
    /* Horizontal strip */
    .news-strip{display:flex;gap:16px;overflow-x:auto;padding:8px 2px 14px 2px;scroll-snap-type:x mandatory;scrollbar-width:none}
    .news-strip::-webkit-scrollbar{display:none}
    .strip-card{flex:0 0 520px;text-decoration:none;color:inherit;scroll-snap-align:start}
    .strip-image-wrapper{position:relative;height:300px;border-radius:16px;overflow:hidden;box-shadow:0 10px 24px rgba(0,0,0,.08);transition:transform .15s ease, box-shadow .2s ease}
    .strip-image{width:100%;height:100%;object-fit:cover;display:block;transform:scale(1.02);transition:transform .35s ease}
    .strip-card:hover .strip-image-wrapper{transform:translateY(-2px);box-shadow:0 14px 28px rgba(0,0,0,.12)}
    .strip-card:hover .strip-image{transform:scale(1.06)}
    .strip-overlay{position:absolute;inset:0;background:linear-gradient(180deg,rgba(0,0,0,0) 30%, rgba(0,0,0,.65) 100%);display:flex;flex-direction:column;justify-content:flex-end;padding:14px}
    .strip-title{color:#fff;font-weight:800;line-height:1.2;margin-bottom:.25rem}
    .strip-desc{color:#fff;opacity:.95;max-height:3.2em;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical}
    .news-card{background:#fff;border-radius:14px;box-shadow:0 10px 24px rgba(0,0,0,.06);overflow:hidden;transition:transform .15s ease, box-shadow .2s ease}
    .news-card:hover{transform:translateY(-3px);box-shadow:0 16px 34px rgba(0,0,0,.12)}
    .news-image-wrapper{position:relative;height:200px;overflow:hidden}
    .news-image{width:100%;height:100%;object-fit:cover;display:block;transform:scale(1.02);transition:transform .4s ease}
    .news-card:hover .news-image{transform:scale(1.06)}
    .placeholder-gradient{width:100%;height:100%;background:linear-gradient(90deg,#eee 25%,#f6f6f6 37%,#eee 63%);animation:shimmer 1.4s infinite;}
    @@keyframes shimmer{0%{background-position:-400px 0}100%{background-position:400px 0}}
    .news-title{font-weight:700;line-height:1.3;margin-bottom:.25rem}
    .news-excerpt{max-height:3.9em;overflow:hidden;text-overflow:ellipsis;display:-webkit-box;-webkit-line-clamp:3;-webkit-box-orient:vertical}
</style>

<!-- Modal de vista rápida -->
<div class="modal fade" id="newsModal" tabindex="-1" aria-hidden="true">
  <div class="modal-dialog modal-lg modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="newsModalTitle">Noticia</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        <img id="newsModalImg" src="" alt="" class="img-fluid mb-3 d-none" style="border-radius:8px;" />
        <div class="text-muted small mb-2" id="newsModalDate"></div>
        <div id="newsModalContent"></div>
      </div>
      <div class="modal-footer">
        <a id="newsModalEdit" class="btn btn-primary">Editar</a>
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
      </div>
    </div>
  </div>
</div>

<script>
    // Auto-scroll horizontal strip
    (function(){
        const strip = document.getElementById('newsStrip');
        if(!strip) return;
        let paused = false;
        strip.addEventListener('mouseenter',()=>paused=true);
        strip.addEventListener('mouseleave',()=>paused=false);
        setInterval(()=>{
            if(paused) return;
            const card = strip.querySelector('.strip-card');
            if(!card) return;
            const step = card.getBoundingClientRect().width + 22;
            const atEnd = Math.ceil(strip.scrollLeft + strip.clientWidth) >= strip.scrollWidth - 1;
            strip.scrollTo({left: atEnd ? 0 : strip.scrollLeft + step, behavior:'smooth'});
        }, 2222);
    })();

    // Vista rápida en modal desde tarjetas
    (function(){
        const modalEl = document.getElementById('newsModal');
        if(!modalEl) return;
        const modal = new bootstrap.Modal(modalEl);
        document.querySelectorAll('.news-card').forEach(card => {
            const btn = card.querySelector('a.btn-primary');
            if(!btn) return;
            btn.addEventListener('click', function(e){
                // Si prefieres seguir yendo a Editar, comenta las 2 líneas siguientes
                e.preventDefault();
                e.stopPropagation();
                const title = card.querySelector('.news-title')?.textContent?.trim() || '';
                const date = card.querySelector('.text-muted')?.textContent?.trim() || '';
                const excerpt = card.querySelector('.news-excerpt')?.textContent?.trim() || '';
                const img = card.querySelector('img.news-image')?.getAttribute('src');
                document.getElementById('newsModalTitle').textContent = title;
                document.getElementById('newsModalDate').textContent = date;
                document.getElementById('newsModalContent').textContent = excerpt;
                const imgEl = document.getElementById('newsModalImg');
                if(img){ imgEl.src = img; imgEl.classList.remove('d-none'); } else { imgEl.classList.add('d-none'); }
                const editHref = btn.getAttribute('href');
                const editLink = document.getElementById('newsModalEdit');
                if(editHref) editLink.setAttribute('href', editHref);
                modal.show();
            });
        });
    })();
</script>

